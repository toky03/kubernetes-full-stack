\subsection{Database}
In the further sections we will use a plain mysql docker container as a database. In order to use the Application completely locally, a local mySQL database has to be installed and a schema for the random generator application needs to be provided for a specific randgenuser.
If there is not yet a local mySQL database installed it can be done with the following command:
\begin{lstlisting}[language=Bash]
sudo apt-get update
sudo apt-get install mysql-server
\end{lstlisting}
After the installation log in to MySQL as root. 
\begin{lstlisting}[language=Bash]
sudo mysql
\end{lstlisting}
Now the Database and the user can be created and permissions to the respective schema will be given.
\begin{lstlisting}[language=SQL]
CREATE database db_example;
CREATE USER 'springuser'@'localhost' IDENTIFIED BY ThePassword;
GRANT ALL PRIVILEGES ON *.db_example TO 'springuser'@'localhost';
\end{lstlisting}
With this, the Database is ready to used by the Random Generator Example from localhost.

\subsection{Random Generator}
The Random Generator will be a verry simple Python App which has an unique Id per Service instance. It will return his id and a new Random Number. For this application we create a folder called RandGen with the following Structure.

\dirtree{%
.1 RandGen.
.2 Dockerfile.
.2 rand\_gen.py.
.2 requirements.txt.
}
The Dockerfile is needed to create the Docker Image which will be used from Kubernetes to Create the Random Generator Service.
rand\_gen.py is the complete Random Generator Python application based on Flask\footnote{More information about Flask can be found on the official Homepage \url{http://flask.pocoo.org/}}.
 \lstinputlisting[language=Python]{Applications/RandGen/rand_gen.py}
In requirements.txt are the Python packages specified. In this case it is flask. therefore this file contains only one line which is
\begin{verbatim}
Flask==1.0.2
\end{verbatim}

The Dockerfile to create the Docker image:


\subsection{Middle Tier}

\input{sections/middletier.tex}


\subsection{Statistic Service}
\input{sections/statistictier.tex}

\subsection{Frontend}
\input{sections/frontend.tex}

\subsection{running with Docker}

\textbf{Create a Network}
\begin{lstlisting}[language=Bash]
docker network create  -d bridge rand-gen-network
\end{lstlisting}

\textbf{Start the Database Container}

\begin{lstlisting}[language=Bash]
docker run -d --name rand-gen-database \
-e MYSQL_ROOT_PASSWORD='password' \
-e MYSQL_USER='random_user' \
-e MYSQL_PASSWORD='random_password' \
-e MYSQL_DATABASE='rand_numbers' \
--network rand-gen-network \
mysql:5.6
\end{lstlisting}

\textbf{Start the Random Generator App}
\begin{lstlisting}[language=Bash]
docker run -d --name=rand-gen-app \
--network rand-gen-network \
rand-gen-image
\end{lstlisting}

\textbf{Start the middle tier Application}
\begin{lstlisting}[language=Bash]
docker run -d \
--name middle-tier \
--network rand-gen-network \
middle-tier
\end{lstlisting}

\textbf{Starting the Stat Tier Application}
\begin{lstlisting}[language=Bash]
docker run -d \
--name stat-tier \
--network rand-gen-network \ 
stat-tier-image
\end{lstlisting}

\textbf{Start the Frontend Service}
\begin{lstlisting}[language=Bash]
docker run -d -p 8080:8080 \
--network rand-gen-network \
--name rand-frontend \
rand-frontend
\end{lstlisting}